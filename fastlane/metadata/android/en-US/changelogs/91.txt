* Various improvements and bugs fixes